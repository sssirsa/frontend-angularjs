<div layout="column"
     layout-align="center stretch"
     ng-repeat="field in vm.fields">
    <section ng-if="field['type']!=='fileUploader'
                         && field['type']!=='catalog'
                         && field['type']!=='options'
                         && field['type']!=='color'
                         && field['type']!=='array'
                         && field['type']!=='catalog_array'
                         && field['type']!=='object'
                         && field['type']!=='array_object'">
        <md-input-container layout="column" class="md-block">
            <!--Field label selection depending on the parameters given-->
            <label ng-if="field['label']">{{field['label']}}</label>
            <label ng-if="!field['label']">{{field['model']}}</label>
            <input ng-required="field.required"
                   aria-label="{{field['model']}}"
                   type="{{field.type}}"
                   name="{{field.model}}"
                   min="{{field.min}}"
                   max="{{field.max}}"
                   ng-disabled="field.lock"
                   ng-pattern="field['validations'].regex"
                   ng-model="vm.objectToModify[field.model]" />
            <div ng-messages="modifyForm[field.model].$error">
                <div ng-message="required">{{field.validations.errors.required}}</div>
                <div ng-message="pattern">{{field.validations.errors.regex}}</div>
            </div>
            <div ng-if="field.hint"
                 class="create-field-hint">
                {{field.hint}}
            </div>
        </md-input-container>
    </section>
    <section ng-if="field['type']==='color'">
        <md-input-container class="md-block">
            <!--Field label selection depending on the parameters given-->
            <label ng-if="field['label']">{{field['label']}}</label>
            <label ng-if="!field['label']">{{field['model']}}</label>
            <input ng-required="field.required"
                   ng-disabled="field.lock"
                   aria-label="{{field['model']}}"
                   type="color"
                   name="{{field.model}}"
                   ng-model="vm.objectToModify[field.model]"
                   value="{{vm.objectToModify[field.model]}}" />
            <div ng-messages="modifyForm[field.model].$error">
                <div ng-message="required">{{field.validations.errors.required}}</div>
                <div ng-message="pattern">{{field.validations.errors.regex}}</div>
            </div>
            <div ng-if="field.hint"
                 class="create-field-hint">
                {{field.hint}}
            </div>
        </md-input-container>
    </section>
    <section ng-if="field['type']==='fileUploader'"
             layout="column">
        <!--Field label selection depending on the parameters given-->
        <label ng-if="field['label']">{{field['label']}}</label>
        <label ng-if="!field['label']">{{field['model']}}</label>
        <file-uploader file-formats="field['validations'].fileUploader.fileFormats"
                       capture="field['validations'].fileUploader.capture"
                       validations="field['validations'].fileUploader.validations"
                       resize="field['validations'].fileUploader.resize"
                       resize-if="field['validations'].fileUploader.resizeIf"
                       max-dimensions="field['validations'].fileUploader.maxDimensions"
                       multiple-files="field['validations'].fileUploader.multipleFiles"
                       allow-folders="field['validations'].fileUploader.allowFolders"
                       max-files="field['validations'].fileUploader.maxfiles"
                       keep="field['validations'].fileUploader.keep"
                       files-selected="vm.filesSelected(files, field)">
        </file-uploader>
    </section>
    <section ng-if="field['type']==='options'">
        <md-input-container class="md-block">
            <!--Field label selection depending on the parameters given-->
            <label ng-if="field['label']">{{field['label']}}</label>
            <label ng-if="!field['label']">{{field['model']}}</label>
            <md-select ng-model="vm.objectToModify[field.model]"
                       ng-required="field.required"
                       ng-disabled="field.lock">
                <md-option ng-repeat="option in field.options.elements"
                           ng-value="option[field.options.model]">
                    {{option[field.options.option]}}
                </md-option>
            </md-select>
        </md-input-container>
        <div ng-if="field.hint"
             class="create-field-hint">
            {{field.hint}}
        </div>
    </section>
    <section ng-if="field['type']==='catalog'">
        <section ng-if="field['catalog'].requires">
            <catalog-select ng-if="vm.objectToModify[field['catalog'].requires]"
                            lock="field.lock"
                            required="field.required"
                            catalog="field.catalog"
                            pagination="field['catalog'].pagination"
                            elements="field['catalog'].elements"
                            soft-delete="field.softDelete"
                            initial="vm.objectToModify[field.bindTo]"
                            on-select="vm.onElementSelect(element,field)">
            </catalog-select>
            <div ng-if="field.hint"
                 class="create-field-hint">
                {{field.hint}}
            </div>
        </section>
        <section ng-if="!field['catalog'].requires">
            <catalog-select catalog="field.catalog"
                            lock="field.lock"
                            required="field.required"
                            pagination="field['catalog'].pagination"
                            elements="field['catalog'].elements"
                            soft-delete="field.softDelete"
                            initial="vm.objectToModify[field.bindTo]"
                            on-select="vm.onElementSelect(element,field)">
            </catalog-select>
            <div ng-if="field.hint"
                 class="modify-field-hint">
                {{field.hint}}
            </div>
        </section>
    </section>
    <section ng-if="field['type']==='array'">
        <md-input-container layout="column" class="md-block">
            <!--Field label selection depending on the parameters given-->
            <label ng-if="field['label']">{{field['label']}}</label>
            <label ng-if="!field['label']">{{field['model']}}</label>
            <md-chips id="{{field['model']}}"
                      ng-model="vm.objectToModify[field.model]"
                      ng-required="field.required"
                      ng-disabled="field.lock"
                      delete-button-label="Remove">
                <input type="text"
                       ng-model="vm.buffer"
                       placeholder="+"
                       ng-pattern="field['validations'].regex">
            </md-chips>
            <div ng-messages="modifyForm[field.model].$error">
                <div ng-message="required">{{field.validations.errors.required}}</div>
                <div ng-message="pattern">{{field.validations.errors.regex}}</div>
            </div>
            <div ng-if="field.hint"
                 class="create-field-hint">
                {{field.hint}}
            </div>
        </md-input-container>
    </section>
    <section ng-if="field['type']==='catalog_array'">
        <section ng-if="field['catalog'].requires">
            <section ng-if="vm.objectToCreate[field['catalog'].requires]">
                <catalog-select required="field.required"
                                catalog="field.catalog"
                                pagination="field['catalog'].pagination"
                                elements="field['catalog'].elements"
                                soft-delete="field.softDelete"
                                lazy="field.catalog.requires"
                                on-select="vm.onArrayElementSelect(element, field, value)">
                </catalog-select>
                <md-chips ng-model="vm[field.model+'_chip']"
                          ng-if="vm[field.model+'_chip'].length>0"
                          md-on-remove="vm.onArrayElementRemove($index, field)"
                          md-removable="true">
                    <md-chip-template>
                        <span>
                            {{$chip[field.catalog.option]}}
                        </span>
                    </md-chip-template>
                </md-chips>
            </section>
            <div ng-if="field.hint"
                 class="create-field-hint">
                {{field.hint}}
            </div>
        </section>
        <section ng-if="!field['catalog'].requires">
            <catalog-select catalog="field.catalog"
                            required="field.required"
                            pagination="field['catalog'].pagination"
                            elements="field['catalog'].elements"
                            soft-delete="field.softDelete"
                            lazy="field.catalog.requires"
                            on-select="vm.onArrayElementSelect(element, field, value)">
            </catalog-select>
            <md-chips ng-model="vm[field.model+'_chip']"
                      ng-if="vm[field.model+'_chip'].length>0"
                      md-on-remove="vm.onArrayElementRemove($index, field)"
                      md-removable="true">
                <md-chip-template>
                    <span>
                        {{$chip[field.catalog.option]}}
                    </span>
                </md-chip-template>
            </md-chips>
            <div ng-if="field.hint"
                 class="create-field-hint">
                {{field.hint}}
            </div>
        </section>
    </section>
    <section ng-if="field['type']==='object'">
        <v-accordion id="accordionModify"
                     class="vAccordion--default"
                     control="accordionModify">
            <v-pane id="v-accordion-pane">
                <v-pane-header id="v-accordion-header">{{field.label}}</v-pane-header>
                <v-pane-content id="v-accordion-content">
                    <catalog-object-modify element="vm.objectToModify[field.model]"
                                           fields="field['fields']"></catalog-object-modify>
                </v-pane-content>
            </v-pane>
        </v-accordion>
    </section>
    <section ng-if="field['type']==='array_object'">
        <v-accordion id="accordionArrayModify"
                     class="vAccordion--default"
                     control="accordionArrayModify">
            <v-pane id="v-accordion-pane">
                <v-pane-header id="v-accordion-header">{{field.label}}</v-pane-header>
                <v-pane-content id="v-accordion-content">
                    <div layout="column"
                         layout-align="stretch center">
                        <catalog-object-modify element="vm.array_objects[field.model]"
                                               fields="field['fields']"></catalog-object-modify>
                        <md-chips ng-model="vm[field.model+'_chip']"
                                  ng-if="vm[field.model+'_chip'].length>0"
                                  md-on-remove="vm.onArrayObjectElementRemove($index, field)"
                                  md-removable="true">
                            <md-chip-template>
                                <span>
                                    {{$chip[field.catalog.option]}}
                                </span>
                            </md-chip-template>
                        </md-chips>
                        <md-button ng-click="vm.addObjectToArray(vm.array_objects[field.model], field)"
                                   class="md-primary"
                                   aria-label="Add">
                            <md-icon md-font-icon="fa fa-plus"></md-icon>
                        </md-button>
                    </div>
                </v-pane-content>
            </v-pane>
        </v-accordion>
    </section>
</div>
