<md-card class="full-width" layout-padding layout="column" laoyut-align="center-stretch">
    <header layout="column" layout-align="center center">
        <h1 translate>CHANGES.LIST.TITLE</h1>
    </header>
    <div layout="row" layout-align="center center" ng-if="vm.showSelector">
        <p>{{'CHANGES.LIST.LABELS.SWITCH.LABEL'|translate}}</p>
        <md-switch ng-model="vm.agencyChange" ng-change="vm.changeSwitch()">
            <!--<p ng-if="vm.entryFromAgency">{{'CHANGES.LIST.LABELS.SWITCH.TRUE'|translate}}</p>
                    <p ng-if="!vm.entryFromAgency">{{'CHANGES.LIST.LABELS.SWITCH.FALSE'|translate}}</p>-->
        </md-switch>
    </div>
    <!--Agency section-->
    <catalog-select class="full-width" ng-if="vm.agencyChange && vm.showSelector"
        catalog="vm.catalogues['origin_udn'].catalog" hint="vm.catalogues['origin_udn'].hint"
        required="vm.catalogues['origin_udn'].required"
        on-select="vm.onOriginSelect(element,vm.catalogues['origin_udn'].binding)">
    </catalog-select>
    <catalog-select class="full-width" ng-if="vm.agencyChange && vm.showSelector"
        catalog="vm.catalogues['destination_udn'].catalog" hint="vm.catalogues['destination_udn'].hint"
        required="vm.catalogues['destination_udn'].required"
        on-select="vm.onOriginSelect(element,vm.catalogues['destination_udn'].binding)">
    </catalog-select>
    <!--Subsidiary section-->
    <catalog-select class="full-width" ng-if="!vm.agencyChange && vm.showSelector"
        catalog="vm.catalogues['origin_subsidiary'].catalog" hint="vm.catalogues['origin_subsidiary'].hint"
        required="vm.catalogues['origin_subsidiary'].required"
        on-select="vm.onOriginSelect(element,vm.catalogues['origin_subsidiary'].binding)">
    </catalog-select>
    <catalog-select class="full-width" ng-if="!vm.agencyChange && vm.showSelector"
        catalog="vm.catalogues['destination_subsidiary'].catalog" hint="vm.catalogues['destination_subsidiary'].hint"
        required="vm.catalogues['destination_subsidiary'].required"
        on-select="vm.onOriginSelect(element,vm.catalogues['destination_subsidiary'].binding)">
    </catalog-select>
</md-card>
<section
    cg-busy="{promise:vm.loadingChanges, message:' ',  templateUrl:'app/mainApp/directives/loading.tmpl.html',wrapperClass:'cg-busy cg-busy-animation'}">
    <md-card ng-if="!vm.changes.length">
        <strong translate>CHANGES.LIST.LABELS.NO_RESULTS</strong>
    </md-card>
    <md-card ng-if="vm.changes.length" ng-click="vm.navigateToDetail(change)" ng-repeat="change in vm.changes">
        <md-toolbar layout-gt-xs="row" layout-align-gt-xs="space-between center" layout="column"
            layout-align="center center" layout-padding>
            <span>
                <strong translate="">CHANGES.LIST.LABELS.ID</strong>
                : {{change.id}}
            </span>
        </md-toolbar>
        <section layout="column" layout-align="center center">
            <span ng-if="change.fecha">
                <strong translate="">CHANGES.LIST.LABELS.DATE</strong>
                <span>{{change.fecha | amDateFormat:'DD/MM/YYYY hh:mm:ss a'}}</span>
            </span>
            <!--Transport section-->
            <section layout="row" layout-align="space-around center">
                <span flex="33" ng-if="change.nombre_chofer" layout-padding>
                    <strong translate>CHANGES.LIST.LABELS.DRIVER_NAME</strong>
                    <span>{{change.nombre_chofer}}</span>
                </span>
                <span flex="33" ng-if="change.linea_transporte.razon_social" layout-padding>
                    <strong translate>CHANGES.LIST.LABELS.TRANSPORT_LINE</strong>
                    <span>{{change.linea_transporte.razon_social}}</span>
                </span>
                <span flex="33" ng-if="change.tipo_transporte.descripcion" layout-padding>
                    <strong translate>CHANGES.LIST.LABELS.TRANSPORT_KIND</strong>
                    <span>{{change.tipo_transporte.descripcion}}</span>
                </span>
            </section>
        </section>
        <section layout="row" layout-align="space-around center">
            <div>
                <!--Origin section-->
                <span ng-if="change.udn_origen" layout-margin>
                    <strong translate>CHANGES.LIST.LABELS.AGENCY</strong>
                    <span>{{change.udn_origen.agencia}}</span>
                </span>
                <span ng-if="change.sucursal_origen" layout-margin>
                    <strong translate>CHANGES.LIST.LABELS.SUBSIDIARY</strong>
                    <span>{{change.sucursal_origen.nombre}}</span>
                </span>
            </div>
            <div>
                <!--Destination section-->
                <span ng-if="change.sucursal_destino" layout-margin>
                    <strong translate>CHANGES.LIST.LABELS.DESTINATION_SUBSIDIARY</strong>
                    <span>{{change.sucursal_destino.nombre}}</span>
                </span>
                <span ng-if="change.udn_destino" layout-margin>
                    <strong translate>CHANGES.LIST.LABELS.DESTINATION_AGENCY</strong>
                    <span>{{change.udn_destino.agencia}}</span>
                </span>
            </div>
        </section>
        <span ng-if="change.descripcion" layout-margin>
            <strong translate>CHANGES.LIST.LABELS.DESCRIPTION</strong>
            <span>{{change.descripcion}}</span>
        </span>
        <md-actions layout="row" layout-align="end center">
            <md-button aria-label="download document button" ng-click="$event.stopPropagation(); vm.generatePDF()"
                disabled class="md-primary md-raised">
                <md-icon md-font-icon="fa fa-file-pdf"></md-icon>
                <span hide-xs>{{"CHANGES.LIST.BUTTONS.PDF"|translate}}</span>
            </md-button>
        </md-actions>
    </md-card>
</section>
<section ng-if="vm.paginationHelper.totalPages>vm.paginationHelper.page" layout="column" layout-align="center center">
    <md-button aria-label="Load more elements button" cg-busy="{promise:vm.loadingMoreChanges, message:' '}"
        ng-click="$event.stopPropagation(); vm.loadMore()" class="md-primary md-raised">
        <md-icon md-font-icon="fa fa-chevron-down"></md-icon>
        <span hide-xs>{{"CHANGES.LIST.BUTTONS.LOAD_MORE"|translate}}</span>
    </md-button>
</section>